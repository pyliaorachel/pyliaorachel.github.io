<!DOCTYPE html>
<html>
	<head>
		<title>ESP8266 with Arduino - Trials and Errors</title>
		<link rel="stylesheet" href="/css/bootstrap.min.css" type="text/css">
		<link rel="stylesheet" href="/css/main.css" type="text/css">
		<link href="https://fonts.googleapis.com/css?family=Antic+Slab|Catamaran|Hind:300|Inconsolata|Josefin+Sans|Muli:300,400i|Poiret+One|Rajdhani:300|Rock+Salt|Ruda|Scope+One|Shadows+Into+Light|Source+Code+Pro|Space+Mono|Amatic+SC:700" rel="stylesheet">
		<link rel="stylesheet" href="/css/github-markdown.css">

		<!-- Place jquery before bootstrap -->
		<script type="text/javascript" src="/js/jquery.min.js"></script>
		<script type="text/javascript" src="/js/bootstrap.min.js"></script>
	</head>
	<body>
		<nav class="navbar navbar-default navbar-fixed-top">
	<div class="container-fluid">

		<div class="navbar-header">
			<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse" aria-expanded="false">
				<span class="sr-only">Toggle navigation</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			<a class="navbar-brand" href="/">MyCoon</a>
		</div>

		<div class="collapse navbar-collapse" id="navbar-collapse">

			<form class="navbar-form navbar-left">
				<div class="form-group">
					<input type="text" class="form-control" id="search-input" placeholder="Search posts from site">
				</div>
			</form>

			<ul class="nav navbar-nav navbar-right" id="nav-links">
				<li class="nav-home"><a href="/">Home</a></li>
				<li class="dropdown nav-blog">
					<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
						Blog<span class="caret"></span>
					</a>
					<ul class="dropdown-menu">
						<li><a href="/blog">MyCoon Blog</a></li>
						<li role="separator" class="divider"></li>
						<li><a href="/blog/categories">Categories</a></li>
						
							
						

						
							
							
							<li class="category">
								<a href="/blog/tech">
									<span>Tech</span>
									<span>13</span>
								</a>
							</li>
						
							
							
							<li class="category">
								<a href="/blog/notes">
									<span>Notes</span>
									<span>5</span>
								</a>
							</li>
						
						<li><a href="/blog/tags">Tags</a></li>
					</ul>
				</li>
				<li class="dropdown nav-tutorial">
					<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
						Tutorials<span class="caret"></span>
					</a>
					<ul class="dropdown-menu">
						<li><a href="/tutorial">MyCoon Tutorial</a></li>
						<li role="separator" class="divider"></li>
						<li><a href="/tutorial/categories">Categories</a></li>
						
							
						

						
							
							
							<li class="category">
								<a href="/tutorial/devops">
								<span>DevOps</span>
								<span>1</span></a>
							</li>
						
							
							
							<li class="category">
								<a href="/tutorial/hardware">
								<span>Hardware</span>
								<span>1</span></a>
							</li>
						
						<li><a href="/tutorial/tags">Tags</a></li>
					</ul>
				</li>
				<li  class="nav-project"><a href="/project">Projects</a></li>
                <!-- <li class="nav-special" id="special"><a href="#">?</a></li> -->
			</ul>
		</div><!-- /.navbar-collapse -->
	</div><!-- /.container-fluid -->
</nav>

            <div id="results-container"></div>

		    <main class="page-content post" aria-label="Content">
	<div class="post-wrapper">
		<div class="wrapper">
	<article class="post-article" itemscope itemtype="http://schema.org/BlogPosting">

		<header class="post-header">
			<h1 class="post-title" itemprop="name headline">ESP8266 with Arduino - Trials and Errors</h1>
			<p class="post-meta">Apr 13, 2017
				 • Hardware
				 • pyliaorachel
			</p>
		</header>

		

		<span class="separator"> • • • </span>

		<div class="post-content" itemprop="articleBody">
			<p>ESP8266 is a popular WiFi module for its extremely affordable price. However, more errors tend to be encountered during the setup of this primitive module. </p>

<p>In this tutorial, the basic steps of setting up ESP8266 through an Arduino board would be covered, and some personal trials and errors will be shared in hope to save people&#39;s time and life if they are stuck with the same problems as I did.</p>

<!--more-->

<hr>

<p><em>I am actually an Arduino beginner and a software person. But in turn, I faced more errors than others, managed to solved them, and have more to share with other people who are also new to Arduino and ESP8266 WiFi module!</em></p>

<h1>Introduction &amp; Setup</h1>

<h2>What is ESP8266?</h2>

<p>An extremely affordable hardware component ($USD 3) to connect to WiFi. </p>

<p>Comes with a variety of different models, which are all based on the same chip. The most popular model is ESP-03, which is of similar price to ESP-01 that I will be using in this tutorial, but with more ports (<em>so regretful, should have picked this one</em>).</p>

<p><img src="http://i2.wp.com/randomnerdtutorials.com/wp-content/uploads/2015/01/all_esp_modules1.png?resize=600%2C337" alt="ESP models"></p>

<h2>Components</h2>

<ol>
<li><a href="https://world.taobao.com/item/40484626466.htm">ESP8266 WiFi module ESP-01</a> (or other)</li>
<li>Arduino Mega board (or others)</li>
<li><a href="https://world.taobao.com/item/522587064231.htm?spm=a312a.7700714.0.0.LOoy8V#detail">Logic level converter</a> (optional)</li>
<li>Breadboard, wires, ...</li>
<li>Arduino IDE (optional)</li>
</ol>

<h2>Before You Start...</h2>

<ol>
<li>If you don&#39;t know what <strong>AT command</strong> is, <strong>DON&#39;T SKIP THE SECTION INTRODUCING IT</strong>. I&#39;ll make it simple, I promise, but don&#39;t directly dive into writing the codes before you know the basics of AT commands, like I did - you&#39;ll end up wasting more time dealing with errors.</li>
<li>Always start with the most basic examples.</li>
<li>Just to let you know, <strong>Arduino is not necessary for you to program ESP8266</strong>. Interestingly, more tutorials I found online deal with it with a USB to serial converter such as the <strong>FTDI232R</strong> module. Follow this tutorial if you have an Arduino board with you, or else you can follow the nice tutorials I took reference on in the reference list.</li>
<li><strong>Arduino IDE is also not mandatory</strong>, there are other ways to write program and upload to ESP8266. But I didn&#39;t do research on it, as that is not my intention for my project.</li>
<li>Setting up a bare ESP8266 module without other assisting development board is <strong>FRUSTRATING</strong>. If you don&#39;t have as much confidence as I did and are just finding a quick way to hack it out for assignments without budget concerns, then go ahead and buy any of those development borads and make your life easier.</li>
</ol>

<h1>Getting Started!</h1>

<ol>
<li>Hooking up ESP8266 + Sending AT Commands</li>
<li>Programing ESP8266</li>
<li>Examples

<ol>
<li>Client Example - Programming ESP8266 Like Arduino</li>
<li>Client Example - Talking to ESP8266 via Arduino</li>
<li>Server Example - Programming ESP8266 Like Arduino</li>
<li>Server Example - Talking to ESP8266 via Arduino</li>
</ol></li>
</ol>

<h2>1. Hooking Up ESP8266 + Sending AT Commands</h2>

<p>Here are the pins for ESP-01 model:</p>

<p><img src="https://raw.githubusercontent.com/pyliaorachel/pyliaorachel.github.io/master/assets/post_img/ESP8266-pins.png" alt="pins"></p>

<h3>Connections</h3>

<div style='margin-bottom: 5px;'>
    <img src='https://raw.githubusercontent.com/pyliaorachel/pyliaorachel.github.io/master/assets/post_img/circuit_1.jpg' width='32%'/>
    <img src='https://raw.githubusercontent.com/pyliaorachel/pyliaorachel.github.io/master/assets/post_img/circuit_2.jpg' width='32%'/>
    <img src='https://raw.githubusercontent.com/pyliaorachel/pyliaorachel.github.io/master/assets/post_img/circuit_4.jpg' width='32%'/>
</div>

<p><img src="https://raw.githubusercontent.com/pyliaorachel/pyliaorachel.github.io/master/assets/post_img/circuit_3.jpg" alt="connections"></p>

<table><thead>
<tr>
<th style="text-align: center">ESP8266</th>
<th style="text-align: center">Arduino</th>
<th style="text-align: center">Others</th>
<th style="text-align: left">Purpose</th>
</tr>
</thead><tbody>
<tr>
<td style="text-align: center">Vcc</td>
<td style="text-align: center">-</td>
<td style="text-align: center">3.3V</td>
<td style="text-align: left">Power supply</td>
</tr>
<tr>
<td style="text-align: center">GND</td>
<td style="text-align: center">GND</td>
<td style="text-align: center">GND</td>
<td style="text-align: left">Ground</td>
</tr>
<tr>
<td style="text-align: center">URXD</td>
<td style="text-align: center">Rx / Tx</td>
<td style="text-align: center">-</td>
<td style="text-align: left">Receive data in</td>
</tr>
<tr>
<td style="text-align: center">UTXD</td>
<td style="text-align: center">Tx / Rx</td>
<td style="text-align: center">-</td>
<td style="text-align: left">Transmit data out</td>
</tr>
<tr>
<td style="text-align: center">CH_PD</td>
<td style="text-align: center">-</td>
<td style="text-align: center">Normally 3.3V</td>
<td style="text-align: left">Chip power down</td>
</tr>
<tr>
<td style="text-align: center">RST</td>
<td style="text-align: center">-</td>
<td style="text-align: center">3.3V for normal operations / GND for reset</td>
<td style="text-align: left">Reset</td>
</tr>
<tr>
<td style="text-align: center">GPIO0</td>
<td style="text-align: center">-</td>
<td style="text-align: center">- for normal operations / GND for flashing firmware</td>
<td style="text-align: left">General purpose I/O pins, but used in flashing firmware</td>
</tr>
<tr>
<td style="text-align: center">GPIO2</td>
<td style="text-align: center">-</td>
<td style="text-align: center">-</td>
<td style="text-align: left">General purpose I/O pin</td>
</tr>
</tbody></table>

<h5>Key Notes</h5>

<ol>
<li><strong>NEVER connect Vcc and other pins to 5V.</strong>

<ul>
<li>ESP8266 operates on 3.3V; connecting pins to 5V may damage the module.</li>
<li>For Rx/Tx pins, the one receiving data through Arduino board should theoretically also be logically shifted down to 3.3V; but many people didn&#39;t encounter problem connecting them directly to each other&#39;s pins, including me.</li>
</ul></li>
<li><strong>DON&#39;T connect 3.3V power pin of Arduino to ESP8266. Use a logic level converter to bring 5V down to 3.3V.</strong>

<ul>
<li>The max limit of current flowing out of that pin is around 50 mA, which usually is not enough. That&#39;s why we need a <strong>logic level converter</strong>; there are <a href="http://randomnerdtutorials.com/how-to-level-shift-5v-to-3-3v/">other ways</a> to bring 5V down to 3.3V, but using logic level converter ensures a better transmission performance. You can also connect it to external power source, which should be the best way to ensure stability.</li>
</ul></li>
<li><strong>Rx-Rx, Tx-Tx: uploading program from computer to ESP8266 via Arduino board; Rx-Tx, Tx-Rx: letting Arduino board talk to ESP8266.</strong>

<ul>
<li>Think of Rx-Rx, Tx-Tx as making Arduino board a channel between the computer and ESP8266; whatever goes to the Arduino board goes to ESP8266, and whatever ESP8266 sends back goes to the computer.</li>
<li>Think of Rx-Tx, Tx-Rx as making Arduino talk to ESP8266, so probably you would have some program in Arduino sending and receiving data/commands via its own serial ports.</li>
</ul></li>
<li><strong>I don&#39;t know what CH_PD port does. Normally just leave it at 3.3V.</strong></li>
<li><strong>If thinking of ESP8266 as an Arduino board, then Rx, Tx, GPIO0, and GPIO2 are the possible digital pins, where Rx/Tx are the predefined Serial ports.</strong>

<ul>
<li>If you are programming directly into ESP8266, then when using up Rx and Tx, you would probably find yourself out of Serial ports for debugging. I&#39;m not sure how it can be solved, but probably you can <a href="https://github.com/esp8266/Arduino/blob/master/doc/reference.md">set GPIO2 as the TX pin for debugging</a> or <a href="http://www.forward.com.au/pfod/ESP8266/GPIOpins/index.html">extend your ports</a>. Not sure if they make sense for ESP-01 model (try it and tell me).</li>
<li><a href="http://www.forward.com.au/pfod/ESP8266/GPIOpins/index.html">Learn more on GPIO ports</a></li>
</ul></li>
</ol>

<h3>Basics of AT Commands</h3>

<p>If you have experience using terminals, then AT commands are of the same concept as those commands you put into the terminal. In terminal, when you input <code>ls</code> and send, some programs would be run, then some outputs would be sent back to your terminal window and shown. You interact via the terminal with your computer software with a set of commands available.</p>

<p>Similarly, <strong>you interact via the serial monitor with your ESP8266 with a set of AT commands available</strong>.</p>

<p>Simple, isn&#39;t it? Instead of guiding you through how to send the various AT commands, I&#39;ll only use 2 AT commands to test the module in the following section - <code>AT</code> and <code>AT+GMR</code>. You should try more yourself looking at <a href="https://www.espressif.com/sites/default/files/documentation/4a-esp8266_at_instruction_set_en.pdf">this doc</a>, including how to scan for available WiFis and connect to them via AT commands, but I do not tend to terrify you with a bunch of those commands, as they are not needed if you are using libraries that wraps up those commands for you.</p>

<p>But knowing how this mechanism drives the interaction with ESP8266 is essential in effective comprehension of the libraries used in the following sections.</p>

<h3>Testing with Andruino IDE</h3>

<p><em>Connection: Rx-Rx, Tx-Tx, RST-3.3V, GPIO0 &amp; GPIO2 floating.</em><br>
Note that you are directly talking to ESP8266 via Arduino board as a channel.</p>

<ol>
<li>Connect and power up your Arduino board &amp; ESP8266</li>
<li>Make sure you Arduino board isn&#39;t loaded with other programs. Either reset your Arduino baord, or upload a <code>BareMinimum</code> example program to it</li>
<li>Open up Arduino IDE, select <code>Tools &gt; Port &gt; YourConnectedPort</code></li>
<li>Open up <code>Serial Monitor</code>, and listen to baudrate <code>115200</code>. You may see some messages bump up; those should be from ESP8266. Recognize the <code>ready</code> message at the end. See image in step 7

<ul>
<li><em>Try other baudrates if you are seeing random symbols, or seeing nothing</em></li>
</ul></li>
<li>Select <code>Both NL &amp; CR</code> option - it adds <code>\r\n</code> after your input line. Necessary for sending a valid AT command</li>
<li>Input <code>AT</code> in your input box and press <code>enter</code>. You should see the response <code>OK</code> from ESP8266
<img src="https://raw.githubusercontent.com/pyliaorachel/pyliaorachel.github.io/master/assets/post_img/AT.png" alt="AT"></li>
<li>Input <code>AT+GMR</code> in your input box and press <code>enter</code>. You should see the version information of your ESP8266
<img src="https://raw.githubusercontent.com/pyliaorachel/pyliaorachel.github.io/master/assets/post_img/AT+GMR.png" alt="AT+GMR"></li>
</ol>

<p>If everything shown is as expected, congratulations, your ESP8266 is working, and you can move on to the programming section. If not, then go to the troubleshooting section for help.</p>

<h4>Alternative1: Testing with PuTTY on Windows</h4>

<p><em>Connection: Rx-Rx, Tx-Tx, RST-3.3V, GPIO0 &amp; GPIO2 floating.</em><br>
Note that you are directly talking to ESP8266 via Arduino board as a channel.</p>

<ol>
<li>Connect and power up your Arduino board &amp; ESP8266</li>
<li>Make sure you Arduino board isn&#39;t loaded with other programs. Either reset your Arduino baord, or upload a <code>BareMinimum</code> example program to it if so</li>
<li>Check the serial port number of your device under <code>Device Manager &gt; Ports &gt; USB Serial Port</code> or <code>Arduino IDE &gt; Tools &gt; Port</code></li>
<li>Open up PuTTY, select <code>Connection type &gt; Serial</code>, input <code>Serial line &gt; COMX</code> where <code>COMX</code> is your connected serial port number, <code>Speed &gt; 115200</code> or other baudrates that work. Press <code>Open</code>. Some messages bump up as in Arduino IDE</li>
<li>Enter <code>AT</code>, <strong>hold down <code>Ctrl</code> key, press <code>m</code> key, press <code>j</code> key, release <code>Ctrl</code> key</strong>. This sends an <code>AT</code> command ending with <code>\r\n</code>. You should see the response <code>OK</code>
<img src="https://raw.githubusercontent.com/pyliaorachel/pyliaorachel.github.io/master/assets/post_img/AT_PUTTY.png" alt="AT"></li>
<li>Enter <code>AT+GMR</code> and do the same thing as above. You should see the version information
<img src="https://raw.githubusercontent.com/pyliaorachel/pyliaorachel.github.io/master/assets/post_img/AT+GMR_PUTTY.png" alt="AT+GMR"></li>
</ol>

<h4>Alternative2: Testing with Arduino Board</h4>

<p><em>Connection: Rx-Tx1, Tx-Rx1, RST-3.3V, GPIO0 &amp; GPIO2 floating for Mega; Rx-D2, Tx-D3, RST-3.3V, GPIO0 &amp; GPIO2 floating for Uno.</em><br>
Note that your Arduino board is the one talking to ESP8266.</p>

<ol>
<li>Connect and power up your Arduino board &amp; ESP8266</li>
<li><p>Open up a new Arduino <code>BareMinimum</code> example, copy and paste the following code:</p>
<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="c1">// For boards with more than 1 hardware serial ports e.g. Mega
</span><span class="kt">void</span> <span class="nf">setup</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="mi">115200</span><span class="p">);</span>             <span class="c1">// Debug message talking on baudrate 115200
</span>  <span class="n">Serial1</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="mi">115200</span><span class="p">);</span>            <span class="c1">// ESP talking on baudrate 115200
</span><span class="p">}</span>

<span class="kt">void</span> <span class="nf">loop</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">Serial1</span><span class="p">.</span><span class="n">available</span><span class="p">())</span> <span class="p">{</span>        <span class="c1">// ESP wants to talk to you
</span>    <span class="n">Serial</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">Serial1</span><span class="p">.</span><span class="n">read</span><span class="p">());</span>   <span class="c1">// Log out what ESP wants to say
</span>  <span class="p">}</span>

  <span class="k">if</span> <span class="p">(</span><span class="n">Serial</span><span class="p">.</span><span class="n">available</span><span class="p">())</span> <span class="p">{</span>         <span class="c1">// You want to talk to ESP (you input and send something via the input field)
</span>    <span class="kt">char</span> <span class="n">chars</span> <span class="o">=</span> <span class="n">Serial</span><span class="p">.</span><span class="n">read</span><span class="p">();</span>     <span class="c1">// Read 1 byte (1 char) at a time
</span>    <span class="n">Serial1</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">chars</span><span class="p">);</span>           <span class="c1">// Tell ESP your words/commands 1 byte (1 char) at a time
</span>  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<ul>
<li><code>Serial</code> is for logging your debug message; <code>Serial1</code> is the <code>Tx1/Rx2</code> pair which your ESP module is connected to.</li>
</ul>
<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="c1">// For boards with only 1 hardware serial port e.g. Uno, we have to use SoftwareSerial ports, i.e. take other digital output pins as your serial port
</span><span class="cp">#include &lt;SoftwareSerial.h&gt;
</span><span class="n">SoftwareSerial</span> <span class="n">ESP</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span> <span class="cm">/* RX:D3, TX:D2 */</span>

<span class="kt">void</span> <span class="nf">setup</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="mi">115200</span><span class="p">);</span>             <span class="c1">// Debug message talking on baudrate 115200
</span>  <span class="n">ESP</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="mi">115200</span><span class="p">);</span>                <span class="c1">// ESP talking on baudrate 115200
</span><span class="p">}</span>

<span class="kt">void</span> <span class="nf">loop</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">ESP</span><span class="p">.</span><span class="n">available</span><span class="p">())</span> <span class="p">{</span>            <span class="c1">// ESP wants to talk to you
</span>    <span class="n">Serial</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">ESP</span><span class="p">.</span><span class="n">read</span><span class="p">());</span>       <span class="c1">// Log out what ESP wants to say
</span>  <span class="p">}</span>

  <span class="k">if</span> <span class="p">(</span><span class="n">Serial</span><span class="p">.</span><span class="n">available</span><span class="p">())</span> <span class="p">{</span>         <span class="c1">// You want to talk to ESP (you input and send something via the input field)
</span>    <span class="kt">char</span> <span class="n">chars</span> <span class="o">=</span> <span class="n">Serial</span><span class="p">.</span><span class="n">read</span><span class="p">();</span>     <span class="c1">// Read 1 byte (1 char) at a time
</span>    <span class="n">ESP</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">chars</span><span class="p">);</span>               <span class="c1">// Tell ESP your words/commands 1 byte (1 char) at a time
</span>  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<ul>
<li><code>SoftwareSerial</code> library is necessary if you are having only 1 Serial port and you want it to be the debug port.</li>
<li>Try <code>AT+GMR</code> command; if you see the message corrupted, i.e. some parts of the message is somehow not readable, don&#39;t assume you&#39;re ok. see troubleshooting section.</li>
</ul></li>
<li><p>Select <code>Tools &gt; Board &gt; YourConnectedArduinoBoard</code>, <code>Tools &gt; Port &gt; YourConnectedPort</code>. Upload the program</p></li>
<li><p>The following steps are the same as step 4 ~ step 7 in the main testing method <strong>Testing with Andruino IDE</strong></p></li>
</ol>

<h2>2. Programing ESP8266</h2>

<p>There are basically 2 ways of using the ESP8266 module: <strong>programming ESP8266 like Arduino</strong> and <strong>talking to ESP8266 via Arduino</strong>. Strictly speaking, the latter one may not really mean to <strong>program</strong> the module; it is the program we upload into Arduino board that sends commands to ESP8266 on behalf of us.</p>

<ul>
<li><strong>Programming ESP8266 like Arduino</strong>: directly upload programs to ESP8266 and treat it like Arduino</li>
<li><strong>Talking to ESP8266 via Arduino</strong>: upload program into Arduino board that sends commands to ESP8266 on behalf of us</li>
</ul>

<p>I didn&#39;t notice the different programming methods at first, and follow whatever the first tutorial I found online that is workable, that is to <strong>program ESP8266 like Arduino</strong>. But later I found that I really need another serial port for communication in addition to the debug port! There are workarounds, as stated in <code>Getting Started! &gt; Hooking Up ESP8266 + Sending AT Commands &gt; Connections &gt; Key Notes</code> in this tutorial, but I was too tired to try so. Then I switched to the other method, in which the debug port is the Mega&#39;s. </p>

<p>However, the latter method is less stable then the first one, as errors tend to come out more often with the extra communication between Arduino and ESP. Choose whatever suits your purpose the best.</p>

<h3>Programming ESP8266 Like Arduino</h3>

<p><em>Connection: Rx-Rx, Tx-Tx, RST-3.3V, GPIO0 &amp; GPIO2 floating.</em><br>
Library: <a href="https://github.com/esp8266/arduino#installing-with-boards-manager">esp8266/arduino</a></p>

<ol>
<li>Go through the <a href="https://github.com/esp8266/arduino#installing-with-boards-manager">installation guide</a></li>
<li>Open up any examples under <code>File &gt; Examples &gt; WiFi</code>, for example, the <code>SimpleWebServerWiFi</code></li>
<li>Replace the <code>ssid</code> and <code>password</code> with a reachable WiFi AP at your place

<ul>
<li>See troubleshooting for the requirements on the AP network</li>
</ul></li>
<li>Change the baudrate to a workable one, in our case, <code>115200</code></li>
<li>Select <code>Tools &gt; Board &gt; ESP8266 Modules &gt; Generic ESP8266 Module</code> (or others if you&#39;re not using bare ESP8266), <code>Tools &gt; Port &gt; YourConnectedPort</code></li>
<li>Upload the program to ESP

<ol>
<li>Diconnect power to ESP</li>
<li>Bring <code>GPIO0</code> to ground</li>
<li>Power up ESP</li>
<li>Pull out <code>GPIO0</code> to float</li>
<li>Click the upload button in IDE</li>
</ol></li>
<li>You should see something like this:
<img src="https://raw.githubusercontent.com/pyliaorachel/pyliaorachel.github.io/master/assets/post_img/Upload_to_ESP.png" alt="Upload to ESP"></li>
</ol>

<h3>Talking to ESP8266 via Arduino</h3>

<p><em>Connection: Rx-Tx1, Tx-Rx1, RST-3.3V, GPIO0 &amp; GPIO2 floating.</em><br>
Library: <a href="https://github.com/itead/ITEADLIB_Arduino_WeeESP8266">itead/ITEADLIB_Arduino_WeeESP8266</a></p>

<ol>
<li>Install the library

<ol>
<li>Download the library as a <code>zip</code> file</li>
<li>Under <code>Sketch &gt; Include Libaray</code>, select <code>Add .ZIP Library...</code></li>
<li>Choose your downloaded <code>zip</code> file</li>
</ol></li>
<li>Open up any examples under <code>File &gt; Examples &gt; ITEADLIB_Arduino_WeeESP8266</code>, for example, the <code>ConnectWiFi</code></li>
<li>Replace the <code>ssid</code> and <code>password</code> with a reachable WiFi AP at your place

<ul>
<li>See troubleshooting for the requirements on the AP network</li>
</ul></li>
<li>Change the baudrate to a workable one, in our case, <code>115200</code></li>
<li>Select <code>Tools &gt; Board &gt; Arduino AVR Boards &gt; Arduino/Genuino Mega or Mega2560</code> (or others), <code>Tools &gt; Port &gt; YourConnectedPort</code></li>
<li>Upload the program to Arduino board</li>
<li>Open up the serial monitor, and you should see messages showing the program interacting with ESP</li>
</ol>

<h2>3. Examples</h2>

<p>The examples are modified from the ones included in the libraries, but I&#39;ll put more comments in the code.</p>

<h3>1. Client Example - Programming ESP8266 Like Arduino</h3>

<p><em>Connection: Rx-Rx, Tx-Tx, RST-3.3V, GPIO0 &amp; GPIO2 floating.</em><br>
<code>HTTPClient</code> is a wrapper of <code>WiFiWebClient</code>, which is more easy to use. No need to wrap the request message yourself.<br>
Modified from: <a href="https://github.com/esp8266/Arduino/blob/master/libraries/ESP8266HTTPClient/examples/BasicHttpClient/BasicHttpClient.ino">esp8266/arduino - BasicHttpClient</a></p>
<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="cm">/* Posting values from 0 to 255 onto dweet.io */</span>

<span class="cp">#include &lt;stdio.h&gt;
#include &lt;ESP8266WiFi.h&gt;
#include &lt;ESP8266HTTPClient.h&gt;
</span>
<span class="cp">#define MAX 255
#define MIN 0
</span>
<span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">ssid</span>     <span class="o">=</span> <span class="s">"xxx"</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">password</span> <span class="o">=</span> <span class="s">"xxx"</span><span class="p">;</span>

<span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">urlPath</span> <span class="o">=</span> <span class="s">"http://dweet.io/dweet/for/thing-name?value="</span><span class="p">;</span>                <span class="c1">// dweet.io is a simple messaging host for IoT devices
</span><span class="kt">char</span> <span class="n">url</span><span class="p">[</span><span class="mi">100</span><span class="p">];</span>

<span class="n">IPAddress</span> <span class="n">ip_static</span><span class="p">(</span><span class="mi">192</span><span class="p">,</span><span class="mi">168</span><span class="p">,</span><span class="mi">137</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>                                                 <span class="c1">// Use a static IP address
</span><span class="n">IPAddress</span> <span class="n">gateway</span><span class="p">(</span><span class="mi">192</span><span class="p">,</span><span class="mi">168</span><span class="p">,</span><span class="mi">137</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>                                                   <span class="c1">// Gateway should be the IP of your connected hotspot device
</span><span class="n">IPAddress</span> <span class="n">subnet</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>                                                    <span class="c1">// Check subnet  through that device as well
</span>
<span class="kt">int</span> <span class="n">value</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">setup</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="mi">115200</span><span class="p">);</span>                                                             <span class="c1">// Serial for debug messages, since we're using ESP like Arduino
</span>
  <span class="c1">// Connect to WiFi network
</span>  <span class="n">WiFi</span><span class="p">.</span><span class="n">config</span><span class="p">(</span><span class="n">ip_static</span><span class="p">,</span> <span class="n">gateway</span><span class="p">,</span> <span class="n">subnet</span><span class="p">);</span>
  <span class="n">WiFi</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="n">ssid</span><span class="p">,</span> <span class="n">password</span><span class="p">);</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n\r</span><span class="s"> </span><span class="se">\n\r</span><span class="s">Working to connect"</span><span class="p">);</span>

  <span class="c1">// Wait for connection
</span>  <span class="k">while</span> <span class="p">(</span><span class="n">WiFi</span><span class="p">.</span><span class="n">status</span><span class="p">()</span> <span class="o">!=</span> <span class="n">WL_CONNECTED</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">delay</span><span class="p">(</span><span class="mi">500</span><span class="p">);</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"."</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">""</span><span class="p">);</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"Connected to "</span><span class="p">);</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">ssid</span><span class="p">);</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"IP address: "</span><span class="p">);</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">WiFi</span><span class="p">.</span><span class="n">localIP</span><span class="p">());</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">loop</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">delay</span><span class="p">(</span><span class="mi">5000</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">WiFi</span><span class="p">.</span><span class="n">status</span><span class="p">()</span> <span class="o">==</span> <span class="n">WL_CONNECTED</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">HTTPClient</span> <span class="n">http</span><span class="p">;</span>

    <span class="c1">// Create URI for the request
</span>    <span class="o">++</span><span class="n">value</span><span class="p">;</span>
    <span class="n">value</span> <span class="o">%=</span> <span class="n">MAX</span><span class="p">;</span>

    <span class="n">sprintf</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="s">"%s%d"</span><span class="p">,</span> <span class="n">urlPath</span><span class="p">,</span> <span class="n">value</span><span class="p">);</span>

    <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"connecting to "</span><span class="p">);</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">url</span><span class="p">);</span>

    <span class="n">http</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="n">url</span><span class="p">);</span>                                                                  <span class="c1">// TCP handshake with host 
</span>
    <span class="kt">int</span> <span class="n">httpCode</span> <span class="o">=</span> <span class="n">http</span><span class="p">.</span><span class="n">GET</span><span class="p">();</span>                                                        <span class="c1">// GET request, return response
</span>    <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"httpCode: "</span><span class="p">);</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">httpCode</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">httpCode</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">String</span> <span class="n">payload</span> <span class="o">=</span> <span class="n">http</span><span class="p">.</span><span class="n">getString</span><span class="p">();</span>
      <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">payload</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="n">http</span><span class="p">.</span><span class="n">end</span><span class="p">();</span>                                                                        <span class="c1">// Close TCP connection
</span>  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h3>2. Client Example - Talking to ESP8266 via Arduino</h3>

<p><em>Connection: Rx-Tx1, Tx-Rx1, RST-3.3V, GPIO0 &amp; GPIO2 floating.</em><br>
Modified from: <a href="https://github.com/itead/ITEADLIB_Arduino_WeeESP8266/blob/master/examples/HTTPGET/HTTPGET.ino">ITEADLIB_Arduino_WeeESP8266 - HTTPGET</a></p>
<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="cp">#include "ESP8266.h"
</span>
<span class="cp">#define SSID        "xxx"
#define PASSWORD    "xxx"
#define HOST_NAME   "dweet.io"
#define HOST_PORT   (80)
</span>
<span class="n">ESP8266</span> <span class="n">wifi</span><span class="p">(</span><span class="n">Serial1</span><span class="p">,</span> <span class="mi">115200</span><span class="p">);</span>

<span class="kt">void</span> <span class="nf">setup</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="mi">115200</span><span class="p">);</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"setup begin</span><span class="se">\r\n</span><span class="s">"</span><span class="p">);</span>

    <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"FW Version:"</span><span class="p">);</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">wifi</span><span class="p">.</span><span class="n">getVersion</span><span class="p">().</span><span class="n">c_str</span><span class="p">());</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">wifi</span><span class="p">.</span><span class="n">setOprToStationSoftAP</span><span class="p">())</span> <span class="p">{</span>
        <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"to station + softap ok</span><span class="se">\r\n</span><span class="s">"</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"to station + softap err</span><span class="se">\r\n</span><span class="s">"</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">wifi</span><span class="p">.</span><span class="n">joinAP</span><span class="p">(</span><span class="n">SSID</span><span class="p">,</span> <span class="n">PASSWORD</span><span class="p">))</span> <span class="p">{</span>
        <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"Join AP success</span><span class="se">\r\n</span><span class="s">"</span><span class="p">);</span>

        <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"IP:"</span><span class="p">);</span>
        <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span> <span class="n">wifi</span><span class="p">.</span><span class="n">getLocalIP</span><span class="p">().</span><span class="n">c_str</span><span class="p">());</span>       
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"Join AP failure</span><span class="se">\r\n</span><span class="s">"</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">wifi</span><span class="p">.</span><span class="n">disableMUX</span><span class="p">())</span> <span class="p">{</span>
        <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"single ok</span><span class="se">\r\n</span><span class="s">"</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"single err</span><span class="se">\r\n</span><span class="s">"</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"setup end</span><span class="se">\r\n</span><span class="s">"</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">loop</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">uint8_t</span> <span class="n">buffer</span><span class="p">[</span><span class="mi">1024</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">};</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">wifi</span><span class="p">.</span><span class="n">createTCP</span><span class="p">(</span><span class="n">HOST_NAME</span><span class="p">,</span> <span class="n">HOST_PORT</span><span class="p">))</span> <span class="p">{</span>
        <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"create tcp ok</span><span class="se">\r\n</span><span class="s">"</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"create tcp err</span><span class="se">\r\n</span><span class="s">"</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kt">char</span> <span class="o">*</span><span class="n">message</span> <span class="o">=</span> <span class="s">"GET /dweet/for/thing-name?value=1 HTTP/1.1</span><span class="se">\r\n</span><span class="s">Host: dweet.io</span><span class="se">\r\n</span><span class="s">Connection: keep-alive</span><span class="se">\r\n\r\n</span><span class="s">"</span><span class="p">;</span>
    <span class="n">wifi</span><span class="p">.</span><span class="n">send</span><span class="p">((</span><span class="k">const</span> <span class="kt">uint8_t</span><span class="o">*</span><span class="p">)</span><span class="n">message</span><span class="p">,</span> <span class="n">strlen</span><span class="p">(</span><span class="n">message</span><span class="p">));</span>

    <span class="kt">uint32_t</span> <span class="n">len</span> <span class="o">=</span> <span class="n">wifi</span><span class="p">.</span><span class="n">recv</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">buffer</span><span class="p">),</span> <span class="mi">10000</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">len</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"Received:["</span><span class="p">);</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">uint32_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">len</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">((</span><span class="kt">char</span><span class="p">)</span><span class="n">buffer</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
        <span class="p">}</span>
        <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"]</span><span class="se">\r\n</span><span class="s">"</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">wifi</span><span class="p">.</span><span class="n">releaseTCP</span><span class="p">())</span> <span class="p">{</span>
        <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"release tcp ok</span><span class="se">\r\n</span><span class="s">"</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"release tcp err</span><span class="se">\r\n</span><span class="s">"</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="n">delay</span><span class="p">(</span><span class="mi">5000</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<h3>3. Server Example - Programming ESP8266 Like Arduino</h3>

<p><em>Connection: Rx-Rx, Tx-Tx, RST-3.3V, GPIO0 &amp; GPIO2 floating.</em><br>
Modified from: <a href="https://learn.adafruit.com/esp8266-temperature-slash-humidity-webserver/code">Adafruit - ESP8266 Temperature / Humidity Webserver</a></p>
<div class="highlight"><pre><code class="language-c" data-lang="c"><span class="cp">#include &lt;ESP8266WiFi.h&gt;
#include &lt;WiFiClient.h&gt;
#include &lt;ESP8266WebServer.h&gt;
</span>
<span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">ssid</span>     <span class="o">=</span> <span class="s">"xxx"</span><span class="p">;</span>
<span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">password</span> <span class="o">=</span> <span class="s">"xxx"</span><span class="p">;</span>

<span class="n">ESP8266WebServer</span> <span class="n">server</span><span class="p">(</span><span class="mi">80</span><span class="p">);</span>                                                           <span class="c1">// Listening on port 80
</span>
<span class="n">String</span> <span class="n">webString</span><span class="o">=</span><span class="s">""</span><span class="p">;</span>                                                                   <span class="c1">// String to display
</span>
<span class="kt">void</span> <span class="nf">handle_root</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">server</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="s">"text/plain"</span><span class="p">,</span> <span class="s">"Hello from esp8266!"</span><span class="p">);</span>                               <span class="c1">// If accessing root, respond this message
</span>  <span class="n">delay</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">setup</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
  <span class="c1">// You can open the Arduino IDE Serial Monitor window to see what the code is doing
</span>  <span class="n">Serial</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="mi">115200</span><span class="p">);</span>

  <span class="c1">// Connect to WiFi network
</span>  <span class="n">WiFi</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="n">ssid</span><span class="p">,</span> <span class="n">password</span><span class="p">);</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n\r</span><span class="s"> </span><span class="se">\n\r</span><span class="s">Working to connect"</span><span class="p">);</span>

  <span class="c1">// Wait for connection
</span>  <span class="k">while</span> <span class="p">(</span><span class="n">WiFi</span><span class="p">.</span><span class="n">status</span><span class="p">()</span> <span class="o">!=</span> <span class="n">WL_CONNECTED</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">delay</span><span class="p">(</span><span class="mi">500</span><span class="p">);</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"."</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">""</span><span class="p">);</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"Connected to "</span><span class="p">);</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">ssid</span><span class="p">);</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"IP address: "</span><span class="p">);</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">WiFi</span><span class="p">.</span><span class="n">localIP</span><span class="p">());</span>

  <span class="n">server</span><span class="p">.</span><span class="n">on</span><span class="p">(</span><span class="s">"/"</span><span class="p">,</span> <span class="n">handle_root</span><span class="p">);</span>                                                         <span class="c1">// If client requests root page, handle it with handle_root subroutine
</span>
  <span class="n">server</span><span class="p">.</span><span class="n">on</span><span class="p">(</span><span class="s">"/test"</span><span class="p">,</span> <span class="p">[](){</span>                                                             <span class="c1">// If client requests /test page, handle it with the code section 
</span>    <span class="n">webString</span><span class="o">=</span><span class="s">"Hello World!"</span><span class="p">;</span>
    <span class="n">server</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="s">"text/plain"</span><span class="p">,</span> <span class="n">webString</span><span class="p">);</span>
  <span class="p">});</span>

  <span class="n">server</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span>
  <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"HTTP server started"</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">loop</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">server</span><span class="p">.</span><span class="n">handleClient</span><span class="p">();</span>                                                                <span class="c1">// Waiting for clients to connect
</span><span class="p">}</span> 
</code></pre></div>
<h3>4. Server Example - Talking to ESP8266 via Arduino</h3>

<p><em>To be released.</em></p>

<h1>Trouble Shooting</h1>

<h4>1. Hooking Up ESP8266 + Sending AT Commands</h4>

<h6>Testing with Andruino IDE</h6>

<ul>
<li>If you do not see <code>ready</code> as the response message, and you find that you can&#39;t send any commands out or receive any responses, your ESP8266 is probably stuck. Try:

<ul>
<li>Reset: <strong>pull GPIO0 to GND, pull RST to GND, pull RST back to Vcc, pull GPIO0 out to floating</strong>.</li>
<li>If not working, power off ESP and power on ESP. Reset again.</li>
<li>If not working, follow <a href="https://www.allaboutcircuits.com/projects/update-the-firmware-in-your-esp8266-wi-fi-module/">this guide</a> on updating your firmware to the latest version. <strong>This is really recommended!!!</strong>

<ul>
<li>Download the latest <a href="http://bbs.espressif.com/viewtopic.php?f=57&amp;t=433">Flash Download Tool</a></li>
<li>Download the latest <a href="http://bbs.espressif.com/viewtopic.php?f=46&amp;t=850">ESP8266 SDK</a>. Choose <strong>Non-OS SDK</strong>.</li>
</ul></li>
</ul></li>
</ul>

<h6>Testing with Andruino Board</h6>

<ul>
<li>If you&#39;re using Arduino Uno and ESP is sending you responses that doesn&#39;t appear readable, the data might be corrupted due to the high baudrate <code>115200</code> that Arduino Uno cannot withstand, or some voltage level problems. Try:

<ul>
<li>Ensure every GNDs are connected, including the ESP&#39;s and Arduino&#39;s GND pins.</li>
<li>If not working, lower the baudrate.</li>
<li>If not working, switch to Mega or other boards.</li>
</ul></li>
</ul>

<h4>2. Programing ESP8266</h4>

<h6>Programming ESP8266 Like Arduino</h6>

<ul>
<li><p>If you don&#39;t know what <code>ssid</code> and <code>password</code> are, <code>ssid</code> is the network name you would see when you want to connect to WiFi in the available WiFi list e.g. <code>eduroam</code>, and <code>password</code> is the password. Note that there&#39;s no options for <code>username</code>, because ESP8266 doesn&#39;t accept enterprise protected access points (WPA2_Enterprise)! So you need to have a private AP available. Some common connection points are from:
<img src="https://raw.githubusercontent.com/pyliaorachel/pyliaorachel.github.io/master/assets/post_img/available_network_types.png" alt="Available network types"></p>

<ul>
<li>Your router</li>
<li>Your mobile phone hotspot</li>
<li><p>Your shared hotspot from a computer that is connected to network cables</p>

<ul>
<li><p>Under Windows platforms, there is a convenient way to share its network as hotspot:</p>

<ol>
<li><p>Open command prompt, run:  </p>
<div class="highlight"><pre><code class="language-" data-lang="">netsh wlan show drivers  
netsh wlan set hostednetwork mode=allow ssid=your-preferred-name key=your-preferred-password
netsh wlan start hostednetwork
</code></pre></div></li>
<li><p>Make sure the network is allowed to be shared</p>

<ol>
<li>Press <code>Windows + r</code> key, enter <code>ncpa.cpl</code>. This opens up <code>Network Connections</code> panel.</li>
<li>Right-click <code>Wi-Fi &gt; properties</code>, switch to <code>Sharing</code> and check the first checkbox under <code>Internet Connection Sharing</code> that reads <code>Allow other network users to connect...</code></li>
</ol></li>
<li><p>Test hotspot</p>

<ul>
<li>Take out your mobile phone, connect to hotspot, and try to go to a website. If everything is fine, then you are good to go.</li>
</ul></li>
</ol></li>
</ul></li>
</ul></li>
<li><p>If you cannot see the uploading progress message, but instead see a lot of mysterious errors such as <code>espcomm_open failed</code>, <code>espcomm_sync failed</code>, and a whole bunch of other possibilities, try:</p>

<ul>
<li>Check your port selection is the right one. Check your circuit connections, ensure the <code>GND</code>s are connected.</li>
<li>If not working, repeat the upload process as state in step 6.</li>
<li>If not working, power off ESP and power on ESP. Upload again.</li>
<li>If not working, unplug your USB and plug in again. Upload again.</li>
<li>If not working, follow <a href="https://www.allaboutcircuits.com/projects/update-the-firmware-in-your-esp8266-wi-fi-module/">this guide</a> on updating your firmware to the latest version. <strong>This is really recommended!!!</strong>

<ul>
<li>Download the latest <a href="http://bbs.espressif.com/viewtopic.php?f=57&amp;t=433">Flash Download Tool</a></li>
<li>Download the latest <a href="http://bbs.espressif.com/viewtopic.php?f=46&amp;t=850">ESP8266 SDK</a>. Choose <strong>Non-OS SDK</strong>.</li>
</ul></li>
</ul></li>
<li><p>If you&#39;re testing as a server, and have no response after you ping the IP address of ESP, try:</p>

<ul>
<li>Connect you computer with WiFi under the same network as ESP8266</li>
</ul></li>
</ul>

<h6>Talking to ESP8266 via Arduino</h6>

<ul>
<li><p>If you&#39;re using Arduino Uno and ESP is sending you responses that doesn&#39;t appear readable, the data might be corrupted due to the high baudrate <code>115200</code> that Arduino Uno cannot withstand, or some voltage level problems. Try:</p>

<ul>
<li>Ensure every GNDs are connected, including the ESP&#39;s and Arduino&#39;s GND pins.</li>
<li>If not working, lower the baudrate.</li>
<li>If not working, switch to Mega or other boards.</li>
</ul></li>
<li><p>If you&#39;re testing as a server, and have no response after you ping the IP address of ESP, try:</p>

<ul>
<li>Connect you computer with WiFi under the same network as ESP8266</li>
</ul></li>
</ul>

<h1>Conclusion</h1>

<p>So I believe that&#39;s all you need to know to successfully setup an ESP8266 module - ok I guess it&#39;s pretty much. Now you know how frustrating the process might be setting up this WiFi module for a software person, and how the cheap price comes with a huge cost. </p>

<p>But I believe I was the one who encountered most of the errors people are likely to encounter and managed to solve them somehow, so I hope the troubleshooting part is comprehensive enough to cover all of your problems. To me, every error popped up appeared to have 100 different possible suggested solutions online, and I almost tried all of them to finally identify one possible valid solution, or sometimes even none of them are valid. I have to say, ESP8266 still have its long way to go.</p>

<p>Finally, I really have to thank the people who wrote the tutorials, instructables, guides, and documentations online, which are mostly included in the following references (cannot put them all). </p>

<p><em>I will post the sample codes up to GitHub along with a summary of this tutorial as a cheatsheet later if I find time.</em></p>

<h1>References</h1>

<p>I bet I&#39;ve searched through 100 webpages along my journey on setting up ESP8266 without an error. The * starred * ones are the recommended ones that really helped me a lot along my way. Others are more or less the same, but I also took reference on.</p>

<ul>
<li>Setting up ESP8266 via USB/TTL converter

<ul>
<li>* <a href="http://www.instructables.com/id/ESP8266-Wi-fi-module-explain-and-connection/?ALLSTEPS">ESP8266 Wi Fi Module Explain and Connection</a></li>
<li><a href="http://rancidbacon.com/files/kiwicon8/ESP8266_WiFi_Module_Quick_Start_Guide_v_1.0.4.pdf">ESP8266 WiFi Module Quick Start Guide</a></li>
<li><a href="http://www.esp8266.com/wiki/doku.php?id=getting-started-with-the-esp8266">Getting Started with ESP8266</a></li>
<li><a href="https://www.allaboutcircuits.com/projects/breadboard-and-program-an-esp-01-circuit-with-the-arduino-ide/">Breadboard and Program an ESP-01 Circuit with the Arduino IDE</a></li>
<li><a href="http://randomnerdtutorials.com/how-to-install-esp8266-board-arduino-ide/">How to Install the ESP8266 Board in Arduino IDE</a></li>
<li><a href="http://makezine.com/2015/04/01/installing-building-arduino-sketch-5-microcontroller/">Installing and Building an Arduino Sketch for the $5 ESP8266 Microcontroller</a></li>
<li><a href="http://fab.cba.mit.edu/classes/863.14/tutorials/Programming/serialwifi.html">Serial-to-WiFi Tutorial using ESP8266</a></li>
</ul></li>
<li>Programming ESP8266 like Arduino

<ul>
<li>* <a href="https://learn.adafruit.com/esp8266-temperature-slash-humidity-webserver/overview">ESP8266 Temperature / Humidity Webserver</a>

<ul>
<li>A little bit outdated on IDE setup, but the program uploading steps saved my life!</li>
</ul></li>
<li>* <a href="http://www.whatimade.today/esp8266-easiest-way-to-program-so-far/">ESP8266 - Easiest way to program so far (Using Arduino IDE)</a></li>
<li><a href="https://www.hackster.io/rayburne/esp8266-01-using-arduino-ide-67a124">ESP8266-01 using Arduino IDE</a></li>
<li><a href="http://www.geekstips.com/esp8266-arduino-tutorial-iot-code-example/">ESP8266 ARDUINO TUTORIAL – WIFI MODULE COMPLETE REVIEW</a></li>
</ul></li>
<li>Talking to ESP8266 via Arduino

<ul>
<li><a href="https://dalpix.com/blog/connecting-your-arduino-wifi-esp-8266-module">Connecting your Arduino to WiFi via an ESP-8266 module</a></li>
<li><a href="http://www.instructables.com/id/Beginners-Guide-to-ESP8266-and-Tweeting-Using-ESP8/">Beginner&#39;s Guide to ESP8266 and Tweeting Using ESP8266</a>

<ul>
<li>Note that the author said the connection of Rx/Tx depends on the version of ESP8266. Sorry but I doubt that.</li>
</ul></li>
</ul></li>
<li>Other nice and comprehensive tutorials

<ul>
<li>* <a href="https://mlwmlw.org/2015/07/%E6%B7%B1%E5%85%A5%E6%B7%BA%E5%87%BA-wifi-%E6%99%B6%E7%89%87-esp8266-with-arduino/">深入淺出 Wifi 晶片 ESP8266 with Arduino</a> <em>Chinese</em> <em>(台灣人好棒棒)</em></li>
<li>* <a href="https://www.allaboutcircuits.com/projects/update-the-firmware-in-your-esp8266-wi-fi-module/">Update the Firmware in Your ESP8266 Wi-Fi Module</a></li>
</ul></li>
<li>Other examples

<ul>
<li><a href="http://www.homeautomationforgeeks.com/ESP8266_samples.shtml">ESP8266 Samples</a></li>
<li><a href="https://github.com/Karang/Ardunet">Arduino port for ESP8266</a></li>
</ul></li>
<li>Documentations

<ul>
<li><a href="https://www.espressif.com/sites/default/files/documentation/4a-esp8266_at_instruction_set_en.pdf">AT Command Set</a></li>
<li><a href="https://room-15.github.io/blog/2015/03/26/esp8266-at-command-reference/#AT+CIPSTATUS">ESP8266 - AT Command Reference</a></li>
</ul></li>
</ul>

		</div>

		<ul class="tag-list">
			

			<li class="tag">
				arduino
			</li>

			

			<li class="tag">
				esp8266
			</li>

			
		</ul>

	</article>

	
		<div id="disqus_thread"></div>
<script>
	var disqus_config = function () {
        this.page.url = "https://pyliaorachel.github.io/tutorial/hardware/arduino/2017/04/13/esp8266-with-arduino-trials-and-errors.html";
        this.page.identifier = "/tutorial/hardware/arduino/2017/04/13/esp8266-with-arduino-trials-and-errors";
	};
	(function() {
	    var d = document, s = d.createElement('script');
        s.src = '//pyliaorachel.disqus.com/embed.js';
	    s.setAttribute('data-timestamp', +new Date());
	    (d.head || d.body).appendChild(s);
	})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

	
</div>

	</div>
</main>

		<footer>
	<div class="container-fluid">
		<div class="row">
			<div class="col-md-4 footer-link">
				<a href="mailto:rachel5566kk@gmail.com">
					<span class="icon icon-email">
						<img src="/assets/svg/email-logo.svg" alt="Email Logo">
					</span>
					<span class="username">rachel5566kk@gmail.com</span>
				</a>
			</div>
			<div class="col-md-4 footer-link">
				<a href="https://github.com/pyliaorachel"  target="_blank">
					<span class="icon icon-github">
						<img src="/assets/svg/github-logo.svg" alt="GitHub Logo">
					</span>
					<span class="username">pyliaorachel</span>
				</a>
			</div>
			<div class="col-md-4 footer-link">
				<a href="https://tw.linkedin.com/in/peiyu-liao" target="_blank">
					<span class="icon icon-linkedin">
						<img src="/assets/svg/linkedin-logo.svg" alt="LinkedIn Logo">
					</span>
					<span class="username">Peiyu Liao</span>
				</a>
			</div>
		</div><!-- /.row -->
		<div class="row">
			<div class="footer-copy-right">
				<p>2018	&copy; Liao Peiyu</p>
			</div >
		</div><!-- /.row -->
	</div><!-- /.container-fluid -->
</footer>

		<script type="text/javascript" src="/js/main.js"></script>
		<script type="text/javascript" src="/js/home.js"></script>
        <script id="dsq-count-scr" src="//pyliaorachel.disqus.com/count.js" async></script>
		<script type="text/javascript" src="/js/simple-jekyll-search.min.js"></script>
        <script>
            window.sjs = new SimpleJekyllSearch({
                searchInput: document.getElementById('search-input'),
                resultsContainer: document.getElementById('results-container'),
                json: '/search.json',
                searchResultTemplate: '<li><div><span class="categories">{categories}</span><a class="title" href="{url}">{title}</a><span class="tags">{tags}</span></div><div><span class="date">{date}</span></div></li>',
                noResultsText: 'No results found.'
            })
        </script>
	</body>
</html>
