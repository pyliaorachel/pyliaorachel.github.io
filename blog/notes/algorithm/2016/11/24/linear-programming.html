<!DOCTYPE html>
<html>
	<head>
		<title>Linear Programming</title>
		<link rel="stylesheet" href="/css/bootstrap.min.css" type="text/css">
		<link rel="stylesheet" href="/css/main.css" type="text/css">
		<link href="https://fonts.googleapis.com/css?family=Antic+Slab|Catamaran|Hind:300|Inconsolata|Josefin+Sans|Muli:300,400i|Poiret+One|Rajdhani:300|Rock+Salt|Ruda|Scope+One|Shadows+Into+Light|Source+Code+Pro|Space+Mono" rel="stylesheet">
		<link rel="stylesheet" href="/css/github-markdown.css">

		<!-- Place jquery before bootstrap -->
		<script type="text/javascript" src="/js/jquery.min.js"></script>
		<script type="text/javascript" src="/js/bootstrap.min.js"></script>
	</head>
	<body>
		<nav class="navbar navbar-default navbar-fixed-top">
	<div class="container-fluid">

		<div class="navbar-header">
			<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse" aria-expanded="false">
				<span class="sr-only">Toggle navigation</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			<a class="navbar-brand" href="/">MyCoon</a>
		</div>

		<div class="collapse navbar-collapse" id="navbar-collapse">

			<form class="navbar-form navbar-left">
				<div class="form-group">
					<input type="text" class="form-control" placeholder="Search">
				</div>
				<button type="submit" class="btn btn-default">Submit</button>
			</form>

			<ul class="nav navbar-nav navbar-right" id="nav-links">
				<li class="nav-home"><a href="/">Home</a></li>
				<li class="dropdown nav-blog">
					<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
						Blog<span class="caret"></span>
					</a>
					<ul class="dropdown-menu">
						<li><a href="/blog">MyCoon Blog</a></li>
						<li role="separator" class="divider"></li>
						<li><a href="/blog/categories">Categories</a></li>
						
							
						

						
							
							
							<li class="category">
								<a href="/blog/notes">
									<span>Notes</span>
									<span>30</span>
								</a>
							</li>
						
							
							
							<li class="category">
								<a href="/blog/tech">
									<span>Tech</span>
									<span>3</span>
								</a>
							</li>
						
						<li><a href="/blog/tags">Tags</a></li>
					</ul>
				</li>
				<li class="dropdown nav-tutorial">
					<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
						Tutorials<span class="caret"></span>
					</a>
					<ul class="dropdown-menu">
						<li><a href="/tutorial">MyCoon Tutorial</a></li>
						<li role="separator" class="divider"></li>
						<li><a href="/tutorial/categories">Categories</a></li>
						
							
						

						
						<li><a href="/tutorial/tags">Tags</a></li>
					</ul>
				</li>
				<li  class="nav-project"><a href="/project">Projects</a></li>
				<li class="nav-special" id="special"><a href="#">?</a></li>
			</ul>
		</div><!-- /.navbar-collapse -->
	</div><!-- /.container-fluid -->
</nav>
		<main class="page-content post" aria-label="Content">
	<div class="post-wrapper">
		<div class="wrapper">
	<article class="post-article" itemscope itemtype="http://schema.org/BlogPosting">

		<header class="post-header">
			<h1 class="post-title" itemprop="name headline">Linear Programming</h1>
			<p class="post-meta">Nov 24, 2016
				 • Notes
				 • pyliaorachel
			</p>
		</header>

		

		<span class="separator"> • • • </span>

		<div class="post-content" itemprop="articleBody">
			<h2>Content</h2>

<ol>
<li>Linear Programming &amp; Reduction Overview</li>
<li>Duality</li>
<li>Simplex Algorithm</li>
<li>Circuit Evaluation</li>
</ol>

<!--more-->

<hr>

<h2>Linear Programming &amp; Reduction Overview</h2>
<div class="highlight"><pre><code class="language-" data-lang="">LP &amp; Reductions ---&gt; Flows &amp; matching
                ---&gt; Duality            ---&gt; Games
                ---&gt; Simplex
</code></pre></div>
<h4>Linear Programming</h4>

<ul>
<li>Objective function

<ul>
<li>Line</li>
<li><strong>Maximization</strong> or <strong>minimization</strong></li>
</ul></li>
<li>Constraints

<ul>
<li>Feasible region</li>
<li><strong>Equations</strong> or <strong>inequalities</strong></li>
</ul></li>
<li>Optimum achieved at a <strong>vertex of feasible region</strong>

<ul>
<li><strong>Simplex method</strong>: <em>hill-climbing</em> on vertices

<ul>
<li>Local = global optimality for linear functions</li>
</ul></li>
</ul></li>
</ul>

<h4>Reduction</h4>

<p>If any subroutine for task Q can also be used to solve P, we say <strong>P reduces to Q</strong>.</p>
<div class="highlight"><pre><code class="language-" data-lang="">x ---&gt; Preprocess --y-&gt; Algorithm for Q --Q(y)--&gt; Postprocess ---&gt; P(x)
</code></pre></div>
<h4>Variants of Linear Programming</h4>

<p>Reduction of variants into <em>standard form</em>:  </p>

<ul>
<li>Maximization to minimization:

<ul>
<li>Coefficients * (-1)</li>
</ul></li>
<li>Inequality to equation:

<ul>
<li><code>sum_i_to_n(ai*xi) &lt;= b</code> &lt;=&gt; <code>sum_i_to_n(ai*xi) + s &lt;= b &amp;&amp; s &gt;= 0</code></li>
<li><code>s</code> = slack variable</li>
</ul></li>
<li>Equation to inequality:

<ul>
<li><code>ax = b</code> &lt;=&gt; <code>ax &lt;= b &amp;&amp; ax &gt;= b</code></li>
</ul></li>
<li>Unsigned variables to signed:

<ul>
<li><code>x</code> &lt;=&gt; <code>x+ - x-</code> where <code>x+, x- &gt;= 0</code></li>
</ul></li>
</ul>

<p><code>min cTx s.t. Ax = b and x ≥ 0</code></p>

<h4>Matrix-Vector Notation</h4>
<div class="highlight"><pre><code class="language-" data-lang="">Objective function:
    c^Tx
    c = [c1, c2, ...], x = [x1, x2, ...]
Constraints:
    Ax &lt;= b
    A = [[c11, c12, ...], [c21, c22, ...], ...], b = [b1, b2, ...]
x &gt;= 0
</code></pre></div>
<h2>Duality</h2>
<div class="highlight"><pre><code class="language-" data-lang=""># Primal LP:
max cTx 
Ax ≤ b 
x ≥ 0

# Dual LP:
min yTb 
yTA ≥ cT 
y ≥ 0
</code></pre></div><div class="highlight"><pre><code class="language-" data-lang=""># Primal LP:
max c1x1 +···+cnxn 
ai1x1+···+ainxn ≤ bi for i ∈ I (inequalities)
ai1x1+···+ainxn = bi for i ∈ E (equalities)
xj ≥ 0 for j ∈ N

# Dual LP:
min b1y1 +···+bmym 
a1jy1+···+amjym ≥ cj for j ∈ N 
a1jy1+···+amjym = cj for j !∈ N 
yi ≥ 0 for i ∈ I # equalities can have unrestricted variables (signed)
</code></pre></div>
<h4>Duality Theorm</h4>

<p>If a linear program has a bounded optimum, then so does its dual, and the two optimum values coincide.</p>

<h4>Duality in Shortest-Path Problem</h4>

<p><a href="http://math.stackexchange.com/questions/861079/shortest-path-problem-dual-formulation-and-proof-of-total-unimodularity">StackExchange</a><br>
<a href="https://en.wikipedia.org/wiki/Shortest_path_problem#Linear_programming_formulation">Wiki</a></p>
<div class="highlight"><pre><code class="language-" data-lang="">max xs - xt
|xu - xv| &lt;= w_uv for all edges {u,v}
</code></pre></div>
<h2>Simplex Algorithm</h2>

<h4>Visualization</h4>
<div class="highlight"><pre><code class="language-" data-lang="">let v be any vertex of the feasible region
while there is a neighbor v' of v with better objective value:
    set v = v'
</code></pre></div><div class="highlight"><pre><code class="language-" data-lang="">x1, ..., xn variables -&gt; n-tuple in n-dimensional space
A linear equation     -&gt; hyperplane in R^n
A linear inequality   -&gt; half-space in R^n
Linear program        -&gt; convex polyhedron in R^n; intersection of all half-spaces
</code></pre></div><div class="highlight"><pre><code class="language-" data-lang="">Vertex: 
    Pick a subset of the inequalities. A vertex is a unique point that satisfies them with equality, and this point happens to be feasible.

Each vertex is specified by a set of n inequalities. (n linear equations to uniquely identify a point)

Neighbor:
    Two vertices are neighbors if they have n-1 defining inequalities in common.
</code></pre></div>
<h4>Algorithm</h4>
<div class="highlight"><pre><code class="language-" data-lang="">max cTx 
Ax ≤ b 
x ≥ 0

1. Set origin to be current vertex.
2. Check whether the current vertex is optimal, i.e. coordinates of local cost vector (c) all &lt;= 0.
3. If so, halt. Else, determine where to move next by increasing some xi for which ci &gt; 0 until we hit some other constraint.
4. Transform the next vertex into origin and repeat.
</code></pre></div>
<h5>Transformation into Origin</h5>
<div class="highlight"><pre><code class="language-" data-lang="">For inequality ai*x ≤ bi, to turn into yi ≥ 0:
    yi = bi - ai*x

Cost function:
    max cu + (c')^T y, cu = value of objective function at u, c' = transformed cost vector
</code></pre></div>
<h4>Issues</h4>

<ol>
<li><p>How to find the starting vertex?</p>

<p>General LPs won&#39;t always have inequalities with positive right-hand sides.</p>
<div class="highlight"><pre><code class="language-" data-lang="">1. Rewrite LP into standard form:
    min cTx s.t. Ax = b and x ≥ 0
2. Make sure right-hand sides of equations are nonnegative:
    if bi &lt; 0, multiply both sides of the ith equation by -1
3. Create new LP:
    - Create m new artificial variables z1, ..., zm &gt;= 0
    - Add zi to left-hand side of the ith equation
    - Objective function: minimize z1+...+zm
4. Starting vertex for new LP:
    zi = bi for all i, other variables 0
5. Run simplex on new LP

If zi+...+zm = 0:
    Optimum vertex of new LP = starting feasible vertex of original LP
Else:
    Original LP not feasible
</code></pre></div></li>
<li><p>Degeneracy?</p>

<p>An LP is <strong>degenerate</strong> if in a basic feasible solution, one of the basic variables takes on a zero value.</p>

<p>In geometry, this means there is an intersection of more than <code>n</code> faces of the polyhedron.  </p>

<ul>
<li>Problem:

<ul>
<li>May return <strong>suboptimal</strong> degenerate vertex, because all neighbors are identical and no better objective</li>
<li>May <strong>loop forever</strong>, bacause if modify simplex, continue to hop from vertex to vertex without improvement<br></li>
</ul></li>
<li><strong>Perturbation</strong>: change each <code>bi</code> by a tiny random amount to <code>bi += εi</code><br></li>
</ul></li>
<li><p>Unboundedness?</p>

<p>Objective function can be arbitrarily large/small.  </p>

<p>Simplex will discover it: when exploring the neighborhood of a vertex, taking out an inequality and adding another leads to underdetermined system of equations that has infinite solutions.</p></li>
</ol>

<h4>Running Time</h4>
<div class="highlight"><pre><code class="language-" data-lang="">Generic LP:
    max cTx s.t. Ax ≤ 0 and x ≥ 0
</code></pre></div>
<ul>
<li>A vertex is where <code>n</code> inequality constraints are satisfied with equality</li>
<li>Each of its neighbors shares <code>n-1</code> inequalities =&gt; <code>n * m</code> neighbors</li>
<li>Finding cost <code>O(1)</code></li>
<li>Checking whether is a true vertex - solving <code>n</code> equations in <code>n</code> unknowns:

<ul>
<li>Gaussian elimination <code>O(n^3)</code> =&gt; total <code>O(nb^4)</code></li>
<li>Use <strong>move to origin</strong>:

<ul>
<li><code>O((m+n)n)</code> overhead to rewrite</li>
<li><code>max cu + (c&#39;)^T y</code>, pick any <code>c&#39;i &gt; 0</code> to move to</li>
<li><code>O(mn)</code> in total</li>
</ul></li>
</ul></li>
<li><code>C(m+n,n)</code> vertices =&gt; upper bound on # of iterations</li>
<li>So <strong>simplex is exponential</strong>; but in practice not exponential</li>
</ul>

<h5>Gaussian Elimination</h5>
<div class="highlight"><pre><code class="language-" data-lang="">Gauss(E,X):
    # Input: A system E = {e1,...,en} of equations in n unknowns X = {x1,...,xn}:
    e1: a11x1 + a12x2 +···+ a1nxn = b1; ···; en: an1x1 + an2x2 +···+ annxn = bn 
    # Output: A solution of the system, if one exists

    if all coefficients ai1 are zero:
        halt with message "either infeasible or not linearly independent"
    if n = 1: return b1/a11

    choose the coefficient ap1 of largest magnitude, and swap equations e1, ep 
    for i = 2 to n:
        ei = ei  − (ai1/a11) * e1
    (x2, . . . , xn) = Gauss(E − {e1}, X − {x1}) 
    x1 = (b1 − sum_j&gt;1(a1j * xj))/a11

    return (x1,...,xn)
</code></pre></div>
<h2>Circuit Evaluation</h2>

<p>The most general problem solvable in polynomial time.  </p>
<div class="highlight"><pre><code class="language-" data-lang="">|true| xg = 1
|false| xg = 0
|OR|  &lt;- h   xg &gt;= xh, xg &gt;= xh'
      &lt;- h'  xg &lt;= xh + xh'
|AND| &lt;- h   xg &lt;= xh, xg &lt;= xh'
      &lt;- h'  xg &gt;= xh + xh' - 1
|NOT| &lt;- h   xg = 1 - xh
</code></pre></div>
<h4>Resources</h4>

<ul>
<li><a href="https://www.utdallas.edu/%7Escniu/OPRE-6201/documents/LP4-Simplex.html">The Simplex Method</a></li>
<li><a href="http://www.cs.yale.edu/homes/aspnes/pinewiki/LinearProgramming.html">Yale LP Notes</a></li>
<li><a href="http://www.pitt.edu/%7Ekaveh/Lin-programming-notes.pdf">Pitt LP Notes</a></li>
<li><a href="http://courses.csail.mit.edu/6.854/06/scribe/s15.pdf">MIT LP Notes</a></li>
<li><a href="http://home.ubalt.edu/ntsbarsh/opre640a/partIII.htm#rsppr">UBalt Flow Notes</a></li>
<li><a href="https://neos-guide.org/content/diet-problem">The Diet Problem</a></li>
</ul>

		</div>

		<ul class="tag-list">
			

			<li class="tag">
				linear programming
			</li>

			

			<li class="tag">
				algorithm
			</li>

			

			<li class="tag">
				CSC373
			</li>

			
		</ul>

	</article>

	
		<div id="disqus_thread"></div>
<script>
	var disqus_config = function () {
	    this.page.url = "https://pyliaorachel.github.io";
	    this.page.identifier = "/blog/notes/algorithm/2016/11/24/linear-programming.html";
	};
	(function() {
	    var d = document, s = d.createElement('script');
	    s.src = '//pyliaorachel.disqus.com/embed.js';
	    s.setAttribute('data-timestamp', +new Date());
	    (d.head || d.body).appendChild(s);
	})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
	
</div>
	</div>
</main>
		<footer>
	<div class="container-fluid">
		<div class="row">
			<div class="col-md-4 footer-link">
				<a href="mailto:rachel5566kk@gmail.com">
					<span class="icon icon-email">
						<img src="/assets/svg/email-logo.svg" alt="Email Logo">
					</span>
					<span class="username">rachel5566kk@gmail.com</span>
				</a>
			</div>
			<div class="col-md-4 footer-link">
				<a href="https://github.com/pyliaorachel"  target="_blank">
					<span class="icon icon-github">
						<img src="/assets/svg/github-logo.svg" alt="GitHub Logo">
					</span>
					<span class="username">pyliaorachel</span>
				</a>
			</div>
			<div class="col-md-4 footer-link">
				<a href="https://tw.linkedin.com/in/peiyu-liao" target="_blank">
					<span class="icon icon-linkedin">
						<img src="/assets/svg/linkedin-logo.svg" alt="LinkedIn Logo">
					</span>
					<span class="username">Peiyu Liao</span>
				</a>
			</div>
		</div><!-- /.row -->
		<div class="row">
			<div class="footer-copy-right">
				<p>2016	&copy; Liao Peiyu</p>
			</div >
		</div><!-- /.row -->
	</div><!-- /.container-fluid -->
</footer>
		<script type="text/javascript" src="/js/main.js"></script>
		<script type="text/javascript" src="/js/home.js"></script>
		<script id="dsq-count-scr" src="//pyliaorachel.disqus.com/count.js" async></script>
	</body>
</html>